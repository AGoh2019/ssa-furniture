<!doctype html>
<html lang="en">

<%- include('../partials/head-products.ejs') %>

<body>

<%- include('../partials/nav-products.ejs') %>

<div class="details content">
    <h2><%=product.name%></h2>
    <div class="content">
        <img class="animate__animated animate__fadeIn" src="<%=product.imageURL%>" alt="product image" style="width: 20%">
        <p style="white-space: pre-line;"><%= product.description %></p>
        <p style="white-space: pre-line;">$<%= product.price %></p>
    </div>
    <a class="delete" data-doc="<%= product._id %>">
        Delete
    </a>
</div>

<%- include('../partials/login-modal.ejs') %>

<!-- UNDER CONSTRUCTION: FOOTER -->

<%- include('../partials/scripts-products.ejs') %>
<script>
    const trashcan = document.querySelector('a.delete');
    trashcan.addEventListener('click', (e)=> {
        const endpoint = `/products/${trashcan.dataset.doc}`;

        fetch(endpoint, {
            method: 'DELETE'
        })
            .then((response)=>response.json())
            .then((data)=>window.location.href= data.redirect)
            .catch(err => console.log(err));
    })
</script>

</body>

</html>